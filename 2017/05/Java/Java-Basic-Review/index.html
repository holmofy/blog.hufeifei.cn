<!doctype html><html lang="en"><head><meta charset="utf-8"><script async src="https://www.googletagmanager.com/gtag/js?id=G-H58NSPXYPF"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-H58NSPXYPF")</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?b3392fb5f6d65fb10354f590338d1ee4",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><script type="text/javascript">!function(t,e,n,c,a,i){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(a=e.createElement(c)).async=1,a.src="https://www.clarity.ms/tag/95vxjpui4h",(i=e.getElementsByTagName(c)[0]).parentNode.insertBefore(a,i)}(window,document,"clarity","script")</script><title>Java语言基础复习与巩固 | holmofy</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="baidu_union_verify" content="b7d27ec946758934fcdf3c5c26386237"><meta description="[TOC] 八种基本数据类型"><meta property="og:type" content="article"><meta property="og:title" content="Java语言基础复习与巩固"><meta property="og:url" content="https://blog.hufeifei.cn/2017/05/Java/Java-Basic-Review/index.html"><meta property="og:site_name" content="holmofy"><link rel="canonical" href="https://blog.hufeifei.cn/2017/05/Java/Java-Basic-Review/index.html"><meta property="description" content="[TOC] 八种基本数据类型"><meta name="description" content="[TOC] 八种基本数据类型"><meta property="og:description" content="[TOC] 八种基本数据类型"><meta property="article:published_time" content="2017-05-13T16:00:00.000Z"><meta property="article:modified_time" content="2024-05-03T05:17:06.695Z"><meta property="article:author" content="胡飞飞"><meta property="article:tag" content="Java"><meta property="article:tag" content="DB"><meta property="article:tag" content="Alibaba"><meta property="article:tag" content="Holmofy"><meta property="article:tag" content="胡飞飞"><meta property="twitter:card" content="summary"><script data-ad-client="ca-pub-7111912103882824" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7111912103882824" crossorigin="anonymous"></script><script async custom-element="amp-auto-ads" src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js"></script><script type="text/javascript" src="//cpro.baidustatic.com/cpro/ui/cm.js" async defer></script><link rel="alternate" href="/atom.xml" title="holmofy" type="application/atom+xml"><link rel="icon" href="//www.hufeifei.cn/favicon.jpg"><link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css"><link href="//unpkg.com/@waline/client@v3/dist/waline.css" rel="stylesheet" type="text/css"><link href="//at.alicdn.com/t/font_841402_efkj8jo1xld.css" rel="stylesheet" type="text/css"><link rel="stylesheet" href="//cdnjs.loli.net/ajax/libs/font-awesome/5.15.3/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/style.css"><link rel="dns-prefetch" href="//static.zhimg.com"><link rel="dns-prefetch" href="//at.alicdn.com"><link rel="dns-prefetch" href="//cdn.jsdelivr.net"><link rel="dns-prefetch" href="//img-blog.csdn.net"><link rel="dns-prefetch" href="//img-blog.csdnimg.cn"><meta name="generator" content="Hexo 6.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style><style>
    figure.codeblock {
       margin: 0;
    }
    figure figcaption .tabs {
      display: flex;
      margin: 0;
    }
    figure figcaption .tabs .tab {
      cursor: pointer;
      list-style: none;
      padding: 5px 15px;
    }
    figure figcaption .tabs .tab.active {
      background: #2d2d2d;
      color: white;
    }
  </style></head><body><amp-auto-ads type="adsense" data-ad-client="ca-pub-7111912103882824"></amp-auto-ads><div id="container"><div id="wrap"><header id="header"><div class="outer" id="header-outer"><div class="inner" id="header-inner"><nav id="main-nav"><a class="nav-icon" id="main-nav-toggle"><i class="fas fa-bars"></i></a><a class="main-nav-link" href="//www.hufeifei.cn">主页</a><a class="main-nav-link" href="/">博客</a><a class="main-nav-link" href="/archives">归档</a><a class="main-nav-link" target="_blank" rel="noopener" href="//algo.hufeifei.cn">算法</a><a class="main-nav-link" href="/book">书籍</a><a class="main-nav-link" href="/github">Github</a></nav><nav id="sub-nav"><a class="nav-icon" id="nav-rss-link" href="/atom.xml" title="RSS Feed"><i class="fa fa-rss"></i></a><a class="nav-icon" id="nav-search-btn" title="Search"><i class="fas fa-search"></i></a></nav><div id="search-form-wrap"><form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="fas fa-search"></i></button><input type="hidden" name="sitesearch" value="https://blog.hufeifei.cn"></form></div></div></div></header><div class="outer"><section id="main"><article class="article article-type-post" id="post-Java/Java-Basic-Review" itemscope itemprop="blogPost"><div class="article-meta"><a class="article-date" href="/2017/05/Java/Java-Basic-Review/"><time datetime="2017-05-13T16:00:00.000Z" itemprop="datePublished">2017-05-14</time></a><div class="article-category"><a class="article-category-link" href="/categories/JAVA/">JAVA</a></div><div class="article-views leancloud_visitors" id="/2017/05/Java/Java-Basic-Review/" data-flag-title="Java语言基础复习与巩固" title="Views"><i class="fas fa-eye"></i><span class="waline-pageview-count" data-path="/2017/05/Java/Java-Basic-Review/"></span></div></div><div class="article-inner"><header class="article-header" style="text-align:center"><h1 class="article-title" itemprop="name">Java语言基础复习与巩固</h1></header><div class="article-entry" itemprop="articleBody"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>[TOC]</p><h2>八种基本数据类型</h2><p>Java语言中有八种基本数据类型：</p><p>​ <code>byte</code>,<code>short</code>,<code>int</code>,<code>long</code>,<code>float</code>,<code>double</code>,<code>char</code>,<code>boolean</code></p><p>C语言因为依赖与CPU平台，数据类型所占字节数可能会因硬件平台以及编译器的不同而有所改变。因为Java是不依赖于任何硬件平台的软件平台，所以它在设计的时候每种数据类型的所占的字节数是固定的(除boolean以外)。</p><table><thead><tr><th align="center">数据类型</th><th align="center">所占字节数</th><th align="left">备注</th></tr></thead><tbody><tr><td align="center">byte</td><td align="center">1Byte</td><td align="left">8位整数范围：<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.186ex" xmlns="http://www.w3.org/2000/svg" width="3.879ex" height="2.088ex" role="img" focusable="false" viewBox="0 -841 1714.6 923"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="msup" transform="translate(778,0)"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z"></path></g></g></g></g></g></svg></mjx-container>~<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.186ex" xmlns="http://www.w3.org/2000/svg" width="6.016ex" height="2.088ex" role="img" focusable="false" viewBox="0 -841 2659 923"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z"></path></g></g></g><g data-mml-node="mo" transform="translate(1158.8,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(2159,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></svg></mjx-container></td></tr><tr><td align="center">short</td><td align="center">2Byte</td><td align="left">16位整数范围：<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.186ex" xmlns="http://www.w3.org/2000/svg" width="4.679ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 2068.1 915.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="msup" transform="translate(778,0)"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(500,0)"></path></g></g></g></g></g></svg></mjx-container>~<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.186ex" xmlns="http://www.w3.org/2000/svg" width="6.816ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 3012.6 915.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(500,0)"></path></g></g></g><g data-mml-node="mo" transform="translate(1512.3,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(2512.6,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></svg></mjx-container></td></tr><tr><td align="center">int</td><td align="center">4Byte</td><td align="left">32位整数范围<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.186ex" xmlns="http://www.w3.org/2000/svg" width="4.679ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 2068.1 915.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="msup" transform="translate(778,0)"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" transform="translate(500,0)"></path></g></g></g></g></g></svg></mjx-container>~<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.186ex" xmlns="http://www.w3.org/2000/svg" width="6.816ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 3012.6 915.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" transform="translate(500,0)"></path></g></g></g><g data-mml-node="mo" transform="translate(1512.3,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(2512.6,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></svg></mjx-container></td></tr><tr><td align="center">long</td><td align="center">8Byte</td><td align="left">64位整数范围<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.186ex" xmlns="http://www.w3.org/2000/svg" width="4.679ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 2068.1 915.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="msup" transform="translate(778,0)"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" transform="translate(500,0)"></path></g></g></g></g></g></svg></mjx-container>~<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align:-.186ex" xmlns="http://www.w3.org/2000/svg" width="6.816ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 3012.6 915.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" transform="translate(500,0)"></path></g></g></g><g data-mml-node="mo" transform="translate(1512.3,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(2512.6,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></svg></mjx-container></td></tr><tr><td align="center">float</td><td align="center">4Byte</td><td align="left">单精度的32位IEEE 754浮点数标准</td></tr><tr><td align="center">double</td><td align="center">8Byte</td><td align="left">双精度的64位IEEE 754浮点数标准</td></tr><tr><td align="center">char</td><td align="center">2Byte</td><td align="left">16位的Unicode字符范围：\u0000 ~ \uffff</td></tr><tr><td align="center">boolean</td><td align="center">不确定</td><td align="left"></td></tr></tbody></table><blockquote><p>注意：Java中boolean比较特殊：单个boolean在编译时映射成int；boolean数组则会被编译成byte数组。用1表示true，0表示false。参考<a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-2.html#jvms-2.3.4">JVM规范</a></p></blockquote><h2>基本数据类型的包装类</h2><p>Java中为上面的八种基本类型提供了包装类，从而让基本类型变成引用类型。有了这些包装类我们就可以在ArrayList，HashMap等Java集合类中存储基本的数据类型了(因为集合类型底层都是使用Object引用类型)。</p><p><img src="http://img-blog.csdn.net/20170623011407927?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSG9sbW9meQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" rel="external noreferrer nofollow noopener" referrerpolicy="no-referrer" alt="基本数据类型的包装类"></p><p>原本JDK1.5之前这些基本数据类型要变成包装类，必须得通过相应的构造函数来对基本数据类型进行包装。这就导致一个问题：如果我往ArrayList中存入一万个整型的1，则需要new出一万个Integer对象。这无疑会消耗很大的内存（Java对象不像C语言结构体那么干净，Java对象头部有很多字段，诸如monitor等信息）。</p><p>于是JDK5.0后提供了自动拆装箱机制。自动拆装箱机制分为两个操作：自动拆箱(auto boxing)和自动装箱(auto unboxing)</p><ul><li><p>自动拆箱：就是程序编译时，遇到数值类型复制给相应的包装类引用，会自动调用相应类型包装类的<code>valueOf</code>方法来获取包装类对象。</p></li><li><p>自动拆箱：就是程序编译时，遇到包装类对象复制给相应的数值类型，会自动调用包装类对象的xxxValue方法来获取相应的数值类型。</p></li></ul><p>比如下面这段简短的代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NumberTest</span> {</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>{</span><br><span class="line">		<span class="type">Integer</span> <span class="variable">i1</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">		<span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> i1;</span><br><span class="line"></span><br><span class="line">		<span class="type">Boolean</span> <span class="variable">b1</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">		<span class="type">boolean</span> <span class="variable">b2</span> <span class="operator">=</span> b1;</span><br><span class="line"></span><br><span class="line">		<span class="type">Character</span> <span class="variable">c1</span> <span class="operator">=</span> <span class="string">'c'</span>;</span><br><span class="line">		<span class="type">char</span> <span class="variable">c2</span> <span class="operator">=</span> c1;</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>使用以下Windows命令对其进行编译后并进行反编译：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Holmofy\Desktop&gt;javac NumberTest.java</span><br><span class="line"></span><br><span class="line">C:\Users\Holmofy\Desktop&gt;<span class="built_in">dir</span>|find <span class="string">"NumberTest"</span></span><br><span class="line"><span class="number">2017</span>/<span class="number">05</span>/<span class="number">23</span>  <span class="number">22</span>:<span class="number">50</span>               <span class="number">599</span> NumberTest.class</span><br><span class="line"><span class="number">2017</span>/<span class="number">05</span>/<span class="number">23</span>  <span class="number">22</span>:<span class="number">48</span>               <span class="number">198</span> NumberTest.java</span><br><span class="line"></span><br><span class="line">C:\Users\Holmofy\Desktop&gt;javap <span class="literal">-c</span> NumberTest &gt; NumberTest.javap</span><br><span class="line"></span><br><span class="line">C:\Users\Holmofy\Desktop&gt;<span class="built_in">dir</span>|find <span class="string">"NumberTest"</span></span><br><span class="line"><span class="number">2017</span>/<span class="number">05</span>/<span class="number">23</span>  <span class="number">22</span>:<span class="number">50</span>               <span class="number">599</span> NumberTest.class</span><br><span class="line"><span class="number">2017</span>/<span class="number">05</span>/<span class="number">23</span>  <span class="number">22</span>:<span class="number">48</span>               <span class="number">198</span> NumberTest.java</span><br><span class="line"><span class="number">2017</span>/<span class="number">05</span>/<span class="number">23</span>  <span class="number">22</span>:<span class="number">51</span>             <span class="number">1</span>,<span class="number">162</span> NumberTest.javap</span><br><span class="line"></span><br><span class="line">C:\Users\Holmofy\Desktop&gt;</span><br></pre></td></tr></table></figure><p>打开得到的反编译文件NumberTest.javap：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Compiled from <span class="string">"NumberTest.java"</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NumberTest</span> {</span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">NumberTest</span><span class="params">()</span>;</span><br><span class="line">    Code:</span><br><span class="line">       <span class="number">0</span>: aload_0</span><br><span class="line">       <span class="number">1</span>: invokespecial #<span class="number">1</span>                  <span class="comment">// Method java/lang/Object."&lt;init&gt;":()V</span></span><br><span class="line">       <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(java.lang.String[])</span>;</span><br><span class="line">    Code:</span><br><span class="line">       <span class="number">0</span>: bipush        <span class="number">10</span></span><br><span class="line">       <span class="number">2</span>: invokestatic  #<span class="number">2</span>                  <span class="comment">// Method java/lang/Integer.valueOf:(I)Ljava/lang/Integer;</span></span><br><span class="line">       <span class="number">5</span>: astore_1</span><br><span class="line">       <span class="number">6</span>: aload_1</span><br><span class="line">       <span class="number">7</span>: invokevirtual #<span class="number">3</span>                  <span class="comment">// Method java/lang/Integer.intValue:()I</span></span><br><span class="line">      <span class="number">10</span>: istore_2</span><br><span class="line">      <span class="number">11</span>: iconst_1</span><br><span class="line">      <span class="number">12</span>: invokestatic  #<span class="number">4</span>                  <span class="comment">// Method java/lang/Boolean.valueOf:(Z)Ljava/lang/Boolean;</span></span><br><span class="line">      <span class="number">15</span>: astore_3</span><br><span class="line">      <span class="number">16</span>: aload_3</span><br><span class="line">      <span class="number">17</span>: invokevirtual #<span class="number">5</span>                  <span class="comment">// Method java/lang/Boolean.booleanValue:()Z</span></span><br><span class="line">      <span class="number">20</span>: istore        <span class="number">4</span></span><br><span class="line">      <span class="number">22</span>: bipush        <span class="number">99</span></span><br><span class="line">      <span class="number">24</span>: invokestatic  #<span class="number">6</span>                  <span class="comment">// Method java/lang/Character.valueOf:(C)Ljava/lang/Character;</span></span><br><span class="line">      <span class="number">27</span>: astore        <span class="number">5</span></span><br><span class="line">      <span class="number">29</span>: aload         <span class="number">5</span></span><br><span class="line">      <span class="number">31</span>: invokevirtual #<span class="number">7</span>                  <span class="comment">// Method java/lang/Character.charValue:()C</span></span><br><span class="line">      <span class="number">34</span>: istore        <span class="number">6</span></span><br><span class="line">      <span class="number">36</span>: <span class="keyword">return</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>确实如此。</p><h2>包装类的缓存池</h2><p>前面说自动装箱调用的相应包装类的valueOf静态方法。那看看这些静态方法的实现：</p><p>Byte</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Byte <span class="title function_">valueOf</span><span class="params">(<span class="type">byte</span> b)</span> {</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> <span class="variable">offset</span> <span class="operator">=</span> <span class="number">128</span>;</span><br><span class="line">    <span class="keyword">return</span> ByteCache.cache[(<span class="type">int</span>)b + offset];</span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>Short</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Short <span class="title function_">valueOf</span><span class="params">(<span class="type">short</span> s)</span> {</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> <span class="variable">offset</span> <span class="operator">=</span> <span class="number">128</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">sAsInt</span> <span class="operator">=</span> s;</span><br><span class="line">    <span class="keyword">if</span> (sAsInt &gt;= -<span class="number">128</span> &amp;&amp; sAsInt &lt;= <span class="number">127</span>) { <span class="comment">// must cache</span></span><br><span class="line">        <span class="keyword">return</span> ShortCache.cache[sAsInt + offset];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Short</span>(s);</span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>Integer</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Integer <span class="title function_">valueOf</span><span class="params">(<span class="type">int</span> i)</span> {</span><br><span class="line">    <span class="keyword">if</span> (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)</span><br><span class="line">        <span class="keyword">return</span> IntegerCache.cache[i + (-IntegerCache.low)];</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Integer</span>(i);</span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>Long</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Long <span class="title function_">valueOf</span><span class="params">(<span class="type">long</span> l)</span> {</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> <span class="variable">offset</span> <span class="operator">=</span> <span class="number">128</span>;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= -<span class="number">128</span> &amp;&amp; l &lt;= <span class="number">127</span>) { <span class="comment">// will cache</span></span><br><span class="line">        <span class="keyword">return</span> LongCache.cache[(<span class="type">int</span>)l + offset];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Long</span>(l);</span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>Float</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Float <span class="title function_">valueOf</span><span class="params">(<span class="type">float</span> f)</span> {</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Float</span>(f);</span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>Double</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Double <span class="title function_">valueOf</span><span class="params">(<span class="type">double</span> d)</span> {</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Double</span>(d);</span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>Character</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Character <span class="title function_">valueOf</span><span class="params">(<span class="type">char</span> c)</span> {</span><br><span class="line">    <span class="keyword">if</span> (c &lt;= <span class="number">127</span>) { <span class="comment">// must cache</span></span><br><span class="line">        <span class="keyword">return</span> CharacterCache.cache[(<span class="type">int</span>)c];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Character</span>(c);</span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>Boolean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Boolean <span class="title function_">valueOf</span><span class="params">(<span class="type">boolean</span> b)</span> {</span><br><span class="line">    <span class="keyword">return</span> (b ? TRUE : FALSE);</span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>通过查看源码发现，总结出下面几个结论：</p><ol><li>Byte，Short，Integer，Long这四种整数包装类型都缓存了<code>-128 ~ 127</code>(即256个数据)。</li><li>Float，Double这两个浮点包装类型没有缓存，valueOf直接调用构造方法进行包装。</li><li>Character包装类型缓存了<code>0 ~ 127</code>总共128个ASCII码值。</li><li>Boolean包装类型缓存了true(TRUE)和false(FALSE)。</li></ol><p>有了这些缓存数据，从而避免了前面所说的大量new对象的问题。但也正因为这些缓存数据，也导致了以下的现象：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NumberTest</span>{</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>{</span><br><span class="line">		<span class="type">Integer</span> <span class="variable">i1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Integer</span>(<span class="number">100</span>);</span><br><span class="line">		<span class="type">Integer</span> <span class="variable">i2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Integer</span>(<span class="number">100</span>);</span><br><span class="line">		System.out.println(i1 == i2);</span><br><span class="line"></span><br><span class="line">		<span class="type">Integer</span> <span class="variable">i3</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line">		<span class="type">Integer</span> <span class="variable">i4</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line">		System.out.println(i3 == i4);</span><br><span class="line"></span><br><span class="line">		<span class="type">Integer</span> <span class="variable">i5</span> <span class="operator">=</span> <span class="number">200</span>;</span><br><span class="line">		<span class="type">Integer</span> <span class="variable">i6</span> <span class="operator">=</span> <span class="number">200</span>;</span><br><span class="line">		System.out.println(i5 == i6);</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">false</span><br><span class="line">true</span><br><span class="line">false</span><br></pre></td></tr></table></figure><p>很明显这是Integer缓存搞的鬼：100是缓存对象，而200不是缓存对象。</p><p>也许你不会觉得这对程序有什么影响，但是如果你了解过IdentityHashMap这个集合类，你就不会这么想了。</p><blockquote><p>关于IdentityHashMap的介绍可以查看<a target="_blank" rel="noopener" href="http://blog.csdn.net/holmofy/article/details/71215548">Java集合框架总结和巩固</a></p></blockquote><h2>Integer缓存池的自定义配置</h2><p>通过查看Byte，Short，Integer，Long源码你会发现，它们缓存都包装在一个相应的类中ByteCache、ShortCache、IntegerCache、LongCache。其中ByteCache，ShortCache，LongCache这三个内部类代码基本一致：都是缓存<code>-127~128</code>的数据。</p><blockquote><p>以下代码均来自jdk1.8.0_131，其他版本不能保证完全相同</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// java.lang.Byte.ByteCache</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ByteCache</span> {</span><br><span class="line">       <span class="keyword">private</span> <span class="title function_">ByteCache</span><span class="params">()</span>{}</span><br><span class="line"></span><br><span class="line">       <span class="keyword">static</span> <span class="keyword">final</span> Byte cache[] = <span class="keyword">new</span> <span class="title class_">Byte</span>[-(-<span class="number">128</span>) + <span class="number">127</span> + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">       <span class="keyword">static</span> {</span><br><span class="line">           <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; cache.length; i++)</span><br><span class="line">               cache[i] = <span class="keyword">new</span> <span class="title class_">Byte</span>((<span class="type">byte</span>)(i - <span class="number">128</span>));</span><br><span class="line">       }</span><br><span class="line">   }</span><br><span class="line"><span class="comment">// java.lang.Short.ShortCache</span></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ShortCache</span> {</span><br><span class="line">       <span class="keyword">private</span> <span class="title function_">ShortCache</span><span class="params">()</span>{}</span><br><span class="line"></span><br><span class="line">       <span class="keyword">static</span> <span class="keyword">final</span> Short cache[] = <span class="keyword">new</span> <span class="title class_">Short</span>[-(-<span class="number">128</span>) + <span class="number">127</span> + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">       <span class="keyword">static</span> {</span><br><span class="line">           <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; cache.length; i++)</span><br><span class="line">               cache[i] = <span class="keyword">new</span> <span class="title class_">Short</span>((<span class="type">short</span>)(i - <span class="number">128</span>));</span><br><span class="line">       }</span><br><span class="line">   }</span><br><span class="line"><span class="comment">// java.lang.Long.LongCache</span></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">LongCache</span> {</span><br><span class="line">       <span class="keyword">private</span> <span class="title function_">LongCache</span><span class="params">()</span>{}</span><br><span class="line"></span><br><span class="line">       <span class="keyword">static</span> <span class="keyword">final</span> Long cache[] = <span class="keyword">new</span> <span class="title class_">Long</span>[-(-<span class="number">128</span>) + <span class="number">127</span> + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">       <span class="keyword">static</span> {</span><br><span class="line">           <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; cache.length; i++)</span><br><span class="line">               cache[i] = <span class="keyword">new</span> <span class="title class_">Long</span>(i - <span class="number">128</span>);</span><br><span class="line">       }</span><br><span class="line">   }</span><br></pre></td></tr></table></figure><p>但IntegerCache类的内容就丰富了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// java.lang.Integer.IntegerCache</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">IntegerCache</span> {</span><br><span class="line">       <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">low</span> <span class="operator">=</span> -<span class="number">128</span>;</span><br><span class="line">       <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> high;</span><br><span class="line">       <span class="keyword">static</span> <span class="keyword">final</span> Integer cache[];</span><br><span class="line"></span><br><span class="line">       <span class="keyword">static</span> {</span><br><span class="line">           <span class="comment">// high value may be configured by property</span></span><br><span class="line">           <span class="type">int</span> <span class="variable">h</span> <span class="operator">=</span> <span class="number">127</span>;</span><br><span class="line">           <span class="type">String</span> <span class="variable">integerCacheHighPropValue</span> <span class="operator">=</span></span><br><span class="line">               sun.misc.VM.getSavedProperty(<span class="string">"java.lang.Integer.IntegerCache.high"</span>);</span><br><span class="line">           <span class="keyword">if</span> (integerCacheHighPropValue != <span class="literal">null</span>) {</span><br><span class="line">               <span class="keyword">try</span> {</span><br><span class="line">                   <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> parseInt(integerCacheHighPropValue);</span><br><span class="line">                   i = Math.max(i, <span class="number">127</span>);</span><br><span class="line">                   <span class="comment">// Maximum array size is Integer.MAX_VALUE</span></span><br><span class="line">                   h = Math.min(i, Integer.MAX_VALUE - (-low) -<span class="number">1</span>);</span><br><span class="line">               } <span class="keyword">catch</span>( NumberFormatException nfe) {</span><br><span class="line">                   <span class="comment">// If the property cannot be parsed into an int, ignore it.</span></span><br><span class="line">               }</span><br><span class="line">           }</span><br><span class="line">           high = h;</span><br><span class="line"></span><br><span class="line">           cache = <span class="keyword">new</span> <span class="title class_">Integer</span>[(high - low) + <span class="number">1</span>];</span><br><span class="line">           <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> low;</span><br><span class="line">           <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>; k &lt; cache.length; k++)</span><br><span class="line">               cache[k] = <span class="keyword">new</span> <span class="title class_">Integer</span>(j++);</span><br><span class="line"></span><br><span class="line">           <span class="comment">// range [-128, 127] must be interned (JLS7 5.1.7)</span></span><br><span class="line">           <span class="keyword">assert</span> IntegerCache.high &gt;= <span class="number">127</span>;</span><br><span class="line">       }</span><br><span class="line"></span><br><span class="line">       <span class="keyword">private</span> <span class="title function_">IntegerCache</span><span class="params">()</span> {}</span><br><span class="line">   }</span><br></pre></td></tr></table></figure><p>可以看出Java会去查找虚拟机的<code>java.lang.Integer.IntegerCache.high</code>属性来决定创建多大的缓存池，如果该属性小于127则使用默认的127作为缓存池的最大界限，否则就使用<code>java.lang.Integer.IntegerCache.high</code>属性中的值。我们可以通过java命令的<code>-XX:AutoBoxCacheMax=&lt;size&gt;</code>来设置JVM的<code>java.lang.Integer.IntegerCache.high</code>属性。</p><p>比如下面这个例子：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> {</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">		<span class="type">Integer</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">256</span>;</span><br><span class="line">		<span class="type">Integer</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">256</span>;</span><br><span class="line">		System.out.println(a == b);</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>按照前面的解释，正常情况下运行会输出<code>false</code>。在运行时进行如下配置就会输出<code>true</code>。</p><p><img src="http://img-blog.csdn.net/20170802125934475?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSG9sbW9meQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" rel="external noreferrer nofollow noopener" referrerpolicy="no-referrer" alt="Integer缓存池的配置"></p><h2>包装类中的其他工具方法</h2><p>在这些基本数据类型的包装类中还提供给我们许多的工具方法。</p><ol><li><p>解析字符串</p><p>在这些包装类中都有<code>parseXxxx</code>这样的静态方法，使用这些静态方法能够将字符串类型的值解析成相应的数据类型。并且对于Byte，Short，Integer，Long这四种整数包装类型还可以在解析时指定基数(也就是使用8进制，使用10进制还是16进制)。</p></li><li><p>转换成字符串</p><p>包装类中还有toString静态方法，能将基本数据类型转换成相应的字符串值。</p></li><li><p>其他：Boolean中的逻辑运算方法、Character中的静态工具方法最多(如判断数字字符、空白字符、西欧字符，转大写、小写)，这些工具方法正等待着各位自己去发掘(避免重复造轮子哦)。</p></li></ol><p><img src="http://img-blog.csdn.net/20170623011508265?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSG9sbW9meQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" rel="external noreferrer nofollow noopener" referrerpolicy="no-referrer" alt="基本数据类型的工具方法"></p><h2>基本数据类型的格式化输出</h2><p>在Java中提供了两个类PrintStream和PrintWriter支持常见数据的格式化输出。</p><blockquote><p>关于PrintStream和PrintWriter的更多详细内容可以参考<a target="_blank" rel="noopener" href="http://blog.csdn.net/holmofy/article/details/72626387">JavaIO总结与巩固</a></p></blockquote><p>比如我们常用的System.out.print等方法也是该类中的方法。</p><p>除了这些方法，还提供了format，printf等方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PrintStream <span class="title function_">format</span><span class="params">(String format, Object ... args)</span>;</span><br><span class="line">PrintStream <span class="title function_">format</span><span class="params">(Locale l, String format, Object ... args)</span></span><br><span class="line">PrintStream <span class="title function_">printf</span><span class="params">(String format, Object ... args)</span></span><br><span class="line">PrintStream <span class="title function_">printf</span><span class="params">(Locale l, String format, Object ... args)</span></span><br><span class="line">PrintWriter <span class="title function_">format</span><span class="params">(String format, Object ... args)</span>;</span><br><span class="line">PrintWriter <span class="title function_">format</span><span class="params">(Locale l, String format, Object ... args)</span></span><br><span class="line">PrintWriter <span class="title function_">printf</span><span class="params">(String format, Object ... args)</span></span><br><span class="line">PrintWriter <span class="title function_">printf</span><span class="params">(Locale l, String format, Object ... args)</span></span><br></pre></td></tr></table></figure><p>这些方法都是直接或间接地调用了<code>java.util.Formatter</code>中的<code>format</code>方法。在使用上这些方法和C语言中的<code>printf</code>方法用法上还是有很多的差别。</p><table><thead><tr><th align="center">转换符</th><th align="center">备注</th></tr></thead><tbody><tr><td align="center">d</td><td align="center">decimal。以十进制输出的整数，java不支持i</td></tr><tr><td align="center">f</td><td align="center">float。以十进制输出的浮点数，java中没有lf</td></tr><tr><td align="center">s</td><td align="center">string。输出字符串，java有字符串连接，这个用的比较少</td></tr><tr><td align="center">n</td><td align="center">newline。换行，java推荐使用%n代替\n</td></tr><tr><td align="center">ty,tY</td><td align="center">time year。ty—两位数年份，tY—四位数年份</td></tr><tr><td align="center">tB</td><td align="center">以地区的方式显示月份，如：May，五月</td></tr><tr><td align="center">tm</td><td align="center">time month。两位数月份不够补零</td></tr><tr><td align="center">td,te</td><td align="center">time day。td—两位数日期不够补零，te—不会补零</td></tr><tr><td align="center">tl</td><td align="center">十二进制的小时数</td></tr><tr><td align="center">tM</td><td align="center">time minutes。两位数分钟数不够补零</td></tr><tr><td align="center">tp</td><td align="center">以地区的方式显示上下午，如：AM|PM，上午|下午</td></tr><tr><td align="center">tD</td><td align="center">time Date。等价于：%tm%td%ty</td></tr><tr><td align="center">08</td><td align="center">以8位字符输出，不够前面补零，并右对齐</td></tr><tr><td align="center">+</td><td align="center">输出正负号(包括符号)</td></tr><tr><td align="center">-</td><td align="center">左对齐</td></tr><tr><td align="center">,</td><td align="center">以地区的方式输出分隔符，如：122,345</td></tr><tr><td align="center">.3</td><td align="center">输出时保留三位小数</td></tr><tr><td align="center">10.3</td><td align="center">以10位字符输出，右对齐，并保留三位小数</td></tr></tbody></table><p>示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"><span class="keyword">import</span> java.util.Locale;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestFormat</span> {</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">      <span class="type">long</span> <span class="variable">n</span> <span class="operator">=</span> <span class="number">461012</span>;</span><br><span class="line">      System.out.format(<span class="string">"%d%n"</span>, n);                  <span class="comment">//  --&gt;  "461012"</span></span><br><span class="line">      System.out.format(<span class="string">"%08d%n"</span>, n);                <span class="comment">//  --&gt;  "00461012"</span></span><br><span class="line">      System.out.format(<span class="string">"%+8d%n"</span>, n);                <span class="comment">//  --&gt;  " +461012"</span></span><br><span class="line">      System.out.format(<span class="string">"%,8d%n"</span>, n);                <span class="comment">//  --&gt;  " 461,012"</span></span><br><span class="line">      System.out.format(<span class="string">"%+,8d%n%n"</span>, n);             <span class="comment">//  --&gt;  "+461,012"</span></span><br><span class="line"></span><br><span class="line">      <span class="type">double</span> <span class="variable">pi</span> <span class="operator">=</span> Math.PI;</span><br><span class="line">      System.out.format(<span class="string">"%f%n"</span>, pi);                 <span class="comment">//  --&gt;  "3.141593"</span></span><br><span class="line">      System.out.format(<span class="string">"%.3f%n"</span>, pi);               <span class="comment">//  --&gt;  "3.142"</span></span><br><span class="line">      System.out.format(<span class="string">"%10.3f%n"</span>, pi);             <span class="comment">//  --&gt;  "     3.142"</span></span><br><span class="line">      System.out.format(<span class="string">"%-10.3f%n"</span>, pi);            <span class="comment">//  --&gt;  "3.142"</span></span><br><span class="line">      System.out.format(Locale.FRANCE,</span><br><span class="line">                        <span class="string">"%-10.4f%n%n"</span>, pi);          <span class="comment">//  --&gt;  "3,1416"</span></span><br><span class="line"></span><br><span class="line">      <span class="type">Calendar</span> <span class="variable">c</span> <span class="operator">=</span> Calendar.getInstance();</span><br><span class="line">      System.out.format(<span class="string">"%tB %te, %tY%n"</span>, c, c, c);  <span class="comment">//  --&gt;  "May 29, 2016"</span></span><br><span class="line">      System.out.format(<span class="string">"%tl:%tM %tp%n"</span>, c, c, c);   <span class="comment">//  --&gt;  "2:34 am"</span></span><br><span class="line">      System.out.format(<span class="string">"%tD%n"</span>, c);                 <span class="comment">//  --&gt;  "05/29/16"</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure><blockquote><p>关于字符格式化的更多内容可以查看JDK中的java.text.*`包中的相关描述。</p></blockquote><h2>Java中的数学运算</h2><p>java像大多数语言一样不仅提供了<code>+</code>,<code>-</code>,<code>*</code>,<code>/</code>,<code>%</code>这样的基本数学运算，还提供了一个Math类来进行更复杂的数学运算。</p><p>调用Math类中的数学方法我们可以使用两种方式：</p><ol><li>因为Math类属于<code>java.lang</code>包下的，所以我们无需另外导包，可以直接Math.xxx()进行调用。</li><li>因为Math类的方法都是<code>static</code>静态的，所以我们可以使用<code>import static java.lang.Math.*</code>方式导入Math类的静态方法。这样我们调用的时候可以不用加类名，直接调用xxx()方法。</li></ol><h3>Math类中的常量和最基本方法</h3><ul><li><code>Math.E</code>, 自然对数的底数</li><li><code>Math.PI</code>, 圆周率</li></ul><table width="100%" border="1" cellpadding="4" cellspacing="3" summary="基础方法摘要"><caption><b>最基础的方法</b></caption><thead><tr><th id="method">方法</th><th width="50%" id="desc">方法描述</th></tr></thead><tbody><tr><td headers="method"><code>double abs(double d)<br>float abs(float f)<br>int abs(int i)<br>long abs(long lng)</code></td><td headers="desc">取绝对值</td></tr><tr><td headers="method"><code>double ceil(double d)</code></td><td headers="desc">向上取整</td></tr><tr><td headers="method"><code>double floor(double d)</code></td><td headers="desc">向下取整</td></tr><tr><td headers="method"><code>double rint(double d)</code></td><td headers="desc">四舍五入取整</td></tr><tr><td headers="method"><code>long round(double d)<br>int round(float f)</code></td><td headers="desc">四舍五入取整</td></tr><tr><td headers="method"><code>double min(double arg1, double arg2)<br>float min(float arg1, float arg2)<br>int min(int arg1, int arg2)<br>long min(long arg1, long arg2)</code></td><td headers="desc">返回两个参数的较小值</td></tr><tr><td headers="method"><code>double max(double arg1, double arg2)<br>float max(float arg1, float arg2)<br>int max(int arg1, int arg2)<br>long max(long arg1, long arg2)</code></td><td headers="desc">返回两个参数的较大值</td></tr></tbody></table><h3>指数运算与幂运算</h3><table width="100%" border="1" cellpadding="4" cellspacing="3" summary="幂运算与指数运算"><caption><b>幂运算与指数运算</b></caption><tbody><tr><th id="method">方法</th><th width="50%" id="desc">方法描述</th></tr><tr><td headers="method"><code>double exp(double d)</code></td><td headers="method">自然底数e的d次幂</td></tr><tr><td headers="method"><code>double log(double d)</code></td><td headers="desc">d的自然对数。ln(d)</td></tr><tr><td headers="method"><code>double pow(double base, double exponent)</code></td><td headers="desc">b的e次幂</td></tr><tr><td headers="method"><code>double sqrt(double d)</code></td><td headers="desc">开平方根。根号d</td></tr></tbody></table><h3>三角函数运算</h3><table width="100%" border="1" cellpadding="4" cellspacing="3" summary="三角函数摘要"><caption><b>三角函数摘要</b></caption><tbody><tr><th id="method">方法</th><th width="50%" id="desc">方法描述</th></tr><tr><td headers="method"><code>double sin(double d)</code></td><td headers="desc">求正弦值</td></tr><tr><td headers="method"><code>double cos(double d)</code></td><td headers="desc">求余弦值</td></tr><tr><td headers="method"><code>double tan(double d)</code></td><td headers="desc">求正切值</td></tr><tr><td headers="method"><code>double asin(double d)</code></td><td headers="desc">反正弦值。arcsine(sin(x))==x</td></tr><tr><td headers="method"><code>double acos(double d)</code></td><td headers="desc">反余弦值。arccos(cos(x))==x</td></tr><tr><td headers="method"><code>double atan(double d)</code></td><td headers="desc">反正切值。arctan(tan(x))==x</td></tr><tr><td headers="method"><code>double atan2(double y, double x)</code></td><td headers="desc">将直角坐标系<code>(x, y)</code> 转成极坐标系 <code>(r, theta)</code> 并返回 <code>theta</code>的值。</td></tr><tr><td headers="method"><code>double toDegrees(double d)<br>double toRadians(double d)</code></td><td headers="desc">将弧度制转换成角度制</td></tr></tbody></table><h3>产生伪随机数</h3><p>Math.random()函数底层使用<code>java.util.Random</code>类随机生成一个大于等于零并且小于一的双精度浮点数：<code>0.0 &lt;= Math.random() &lt; 1.0</code>。这和C语言的rand()函数还是有区别，rand函数生成的是0到32767(RAND_MAX)之间的数。这个方法比较鸡肋，我们完全可以使用<code>java.util.Random</code>或<code>java.security.SecureRandom</code>这两个类来生成随机数。</p><h2>Java中的字符串</h2><h3>Java字符串与C/C++字符串对比</h3><p>字符串是程序设计中最常用到的数据类型。</p><p>Java中有一个专门的类String用来代表字符串，而不像C/C++中字符串仅仅是一个以<code>\0</code>结尾的字符数组（C语言的字符串常量与字符数组还是有很大的区别的）。</p><blockquote><p>C/C++：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> str[] = <span class="string">"Hello World"</span>;<span class="comment">// 字符串长度等于实际字符长度加上一个\0结尾符</span></span><br><span class="line"><span class="comment">// sizeof(str) == 12 == 11+1</span></span><br></pre></td></tr></table></figure></blockquote><blockquote><p>Java：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Java数组封装了数组长度，cArr.length = 11;</span></span><br><span class="line"><span class="type">char</span>[] cArr = {<span class="string">'H'</span>,<span class="string">'e'</span>,<span class="string">'l'</span>,<span class="string">'l'</span>,<span class="string">'o'</span>,<span class="string">' '</span>,<span class="string">' W'</span>,<span class="string">'o'</span>,<span class="string">'r'</span>,<span class="string">'l'</span>,<span class="string">'d'</span>,<span class="string">'!'</span>};</span><br><span class="line"><span class="type">String</span> <span class="variable">str1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(cArr);<span class="comment">// String类封装了char[]</span></span><br><span class="line"><span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> <span class="string">"Hello World!"</span>;</span><br><span class="line"><span class="comment">// Java中不支持char[] str = "Hello World";因为字符串常量也是String类对象。</span></span><br></pre></td></tr></table></figure></blockquote><p>正因C/C++语言字符串是基本数据类型，导致了C++中各种对字符串类的封装：如STL中的<code>std::string</code>，MFC中的<code>CString</code>，Qt中的<code>QString</code>…各种库中都有自己实现的封装。</p><p>另外Java中char类型占两个字节，使用Unicode字符集UTF-16编码；而C/C++的char类型占一个字节，使用ASCII编码。</p><blockquote><p>关于编码的问题可以查看我的这篇文章：<a target="_blank" rel="noopener" href="http://blog.csdn.net/holmofy/article/details/72846118">从ASCII、ISO-8859、GB2312、GBK到Unicode的UCS-2、UCS-4、UTF-8、UTF-16、UTF-32</a></p></blockquote><h3>Java字符串的不可变性</h3><p>尽管Java的String类中提供了像<code>replace()</code>这样的修改字符串的方法，但实际上Java的String类是一个不可变类型：一旦创建，对象的字符内容不可修改。那些<code>replace()</code>之类的方法都是重新创建一个String类对象作为返回值。</p><p>那我们平时经常使用“<code>+</code>”操作符作为来进行字符串连接，是怎样实现的呢？</p><h3>Java的字符串连接底层实现</h3><p>下面我们写一个简单的小Demo来看一下String的字符串连接：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringTest</span>{</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>{</span><br><span class="line">		<span class="type">String</span> <span class="variable">a</span> <span class="operator">=</span> <span class="string">"Hello"</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">b</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">"Hello"</span>);</span><br><span class="line">		System.out.println(a == b);</span><br><span class="line">		<span class="type">String</span> <span class="variable">c</span> <span class="operator">=</span> <span class="string">"Hello"</span>;</span><br><span class="line">		System.out.println(a == c);</span><br><span class="line">		<span class="type">String</span> <span class="variable">d</span> <span class="operator">=</span> c + <span class="string">"World!"</span>;</span><br><span class="line">		<span class="type">String</span> <span class="variable">e</span> <span class="operator">=</span> <span class="string">"Hello"</span> + <span class="string">"World!"</span>;</span><br><span class="line">		System.out.println(d == e);</span><br><span class="line">		<span class="type">String</span> <span class="variable">f</span> <span class="operator">=</span> <span class="string">"HelloWorld!"</span>;</span><br><span class="line">		System.out.println(e == f);</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>我们编译运行，然后反编译一下看看底层实现</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Holmofy\Desktop&gt;javac StringTest.java</span><br><span class="line"></span><br><span class="line">C:\Users\Holmofy\Desktop&gt;<span class="built_in">dir</span>|find <span class="string">"StringTest"</span></span><br><span class="line"><span class="number">2017</span>/<span class="number">06</span>/<span class="number">02</span>  <span class="number">20</span>:<span class="number">01</span>             <span class="number">1</span>,<span class="number">233</span> StringTest.class</span><br><span class="line"><span class="number">2017</span>/<span class="number">05</span>/<span class="number">26</span>  <span class="number">16</span>:<span class="number">04</span>               <span class="number">441</span> StringTest.java</span><br><span class="line"></span><br><span class="line">C:\Users\Holmofy\Desktop&gt;javap <span class="literal">-c</span> StringTest &gt; StringTest.javap</span><br><span class="line"></span><br><span class="line">C:\Users\Holmofy\Desktop&gt;<span class="built_in">dir</span>|find <span class="string">"StringTest"</span></span><br><span class="line"><span class="number">2017</span>/<span class="number">06</span>/<span class="number">02</span>  <span class="number">20</span>:<span class="number">01</span>             <span class="number">1</span>,<span class="number">233</span> StringTest.class</span><br><span class="line"><span class="number">2017</span>/<span class="number">05</span>/<span class="number">26</span>  <span class="number">16</span>:<span class="number">04</span>               <span class="number">441</span> StringTest.java</span><br><span class="line"><span class="number">2017</span>/<span class="number">06</span>/<span class="number">02</span>  <span class="number">20</span>:<span class="number">02</span>             <span class="number">5</span>,<span class="number">397</span> StringTest.javap</span><br></pre></td></tr></table></figure><p>我们先不讨论运行结果，先来看一下StringTest.javap这个反编译出来的文件：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">Compiled from <span class="string">"StringTest.java"</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringTest</span> {</span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">StringTest</span><span class="params">()</span>;</span><br><span class="line">    Code:</span><br><span class="line">       <span class="number">0</span>: aload_0</span><br><span class="line">       <span class="number">1</span>: invokespecial #<span class="number">1</span>                  <span class="comment">// Method java/lang/Object."&lt;init&gt;":()V</span></span><br><span class="line">       <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(java.lang.String[])</span>;</span><br><span class="line">    Code:</span><br><span class="line">       <span class="number">0</span>: ldc           #<span class="number">2</span>                  <span class="comment">// String Hello</span></span><br><span class="line">       <span class="number">2</span>: astore_1</span><br><span class="line">       <span class="number">3</span>: <span class="keyword">new</span>           #<span class="number">3</span>                  <span class="comment">// class java/lang/String</span></span><br><span class="line">       <span class="number">6</span>: dup</span><br><span class="line">       <span class="number">7</span>: ldc           #<span class="number">2</span>                  <span class="comment">// String Hello</span></span><br><span class="line">       <span class="number">9</span>: invokespecial #<span class="number">4</span>                  <span class="comment">// Method java/lang/String."&lt;init&gt;":(Ljava/lang/String;)V</span></span><br><span class="line">      <span class="number">12</span>: astore_2</span><br><span class="line">      <span class="number">13</span>: getstatic     #<span class="number">5</span>                  <span class="comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">      <span class="number">16</span>: aload_1</span><br><span class="line">      <span class="number">17</span>: aload_2</span><br><span class="line">      <span class="number">18</span>: if_acmpne     <span class="number">25</span></span><br><span class="line">      <span class="number">21</span>: iconst_1</span><br><span class="line">      <span class="number">22</span>: goto          <span class="number">26</span></span><br><span class="line">      <span class="number">25</span>: iconst_0</span><br><span class="line">      <span class="number">26</span>: invokevirtual #<span class="number">6</span>                  <span class="comment">// Method java/io/PrintStream.println:(Z)V</span></span><br><span class="line">      <span class="number">29</span>: ldc           #<span class="number">2</span>                  <span class="comment">// String Hello</span></span><br><span class="line">      <span class="number">31</span>: astore_3</span><br><span class="line">      <span class="number">32</span>: getstatic     #<span class="number">5</span>                  <span class="comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">      <span class="number">35</span>: aload_1</span><br><span class="line">      <span class="number">36</span>: aload_3</span><br><span class="line">      <span class="number">37</span>: if_acmpne     <span class="number">44</span></span><br><span class="line">      <span class="number">40</span>: iconst_1</span><br><span class="line">      <span class="number">41</span>: goto          <span class="number">45</span></span><br><span class="line">      <span class="number">44</span>: iconst_0</span><br><span class="line">      <span class="number">45</span>: invokevirtual #<span class="number">6</span>                  <span class="comment">// Method java/io/PrintStream.println:(Z)V</span></span><br><span class="line">      <span class="number">48</span>: <span class="keyword">new</span>           #<span class="number">7</span>                  <span class="comment">// class java/lang/StringBuilder</span></span><br><span class="line">      <span class="number">51</span>: dup</span><br><span class="line">      <span class="number">52</span>: invokespecial #<span class="number">8</span>                  <span class="comment">// Method java/lang/StringBuilder."&lt;init&gt;":()V</span></span><br><span class="line">      <span class="number">55</span>: aload_3</span><br><span class="line">      <span class="number">56</span>: invokevirtual #<span class="number">9</span>                  <span class="comment">// Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span></span><br><span class="line">      <span class="number">59</span>: ldc           #<span class="number">10</span>                 <span class="comment">// String World!</span></span><br><span class="line">      <span class="number">61</span>: invokevirtual #<span class="number">9</span>                  <span class="comment">// Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span></span><br><span class="line">      <span class="number">64</span>: invokevirtual #<span class="number">11</span>                 <span class="comment">// Method java/lang/StringBuilder.toString:()Ljava/lang/String;</span></span><br><span class="line">      <span class="number">67</span>: astore        <span class="number">4</span></span><br><span class="line">      <span class="number">69</span>: ldc           #<span class="number">12</span>                 <span class="comment">// String HelloWorld!</span></span><br><span class="line">      <span class="number">71</span>: astore        <span class="number">5</span></span><br><span class="line">      <span class="number">73</span>: getstatic     #<span class="number">5</span>                  <span class="comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">      <span class="number">76</span>: aload         <span class="number">4</span></span><br><span class="line">      <span class="number">78</span>: aload         <span class="number">5</span></span><br><span class="line">      <span class="number">80</span>: if_acmpne     <span class="number">87</span></span><br><span class="line">      <span class="number">83</span>: iconst_1</span><br><span class="line">      <span class="number">84</span>: goto          <span class="number">88</span></span><br><span class="line">      <span class="number">87</span>: iconst_0</span><br><span class="line">      <span class="number">88</span>: invokevirtual #<span class="number">6</span>                  <span class="comment">// Method java/io/PrintStream.println:(Z)V</span></span><br><span class="line">      <span class="number">91</span>: ldc           #<span class="number">12</span>                 <span class="comment">// String HelloWorld!</span></span><br><span class="line">      <span class="number">93</span>: astore        <span class="number">6</span></span><br><span class="line">      <span class="number">95</span>: getstatic     #<span class="number">5</span>                  <span class="comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span></span><br><span class="line">      <span class="number">98</span>: aload         <span class="number">5</span></span><br><span class="line">     <span class="number">100</span>: aload         <span class="number">6</span></span><br><span class="line">     <span class="number">102</span>: if_acmpne     <span class="number">109</span></span><br><span class="line">     <span class="number">105</span>: iconst_1</span><br><span class="line">     <span class="number">106</span>: goto          <span class="number">110</span></span><br><span class="line">     <span class="number">109</span>: iconst_0</span><br><span class="line">     <span class="number">110</span>: invokevirtual #<span class="number">6</span>                  <span class="comment">// Method java/io/PrintStream.println:(Z)V</span></span><br><span class="line">     <span class="number">113</span>: <span class="keyword">return</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>可以看出字符串连接实际上是new一个StringBuilder对象，然后调用它的append方法，最后调用toString方法转换成String类型的不可变对象。</p><p>我们将结果运行出来：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Holmofy\Desktop&gt;java StringTest</span><br><span class="line">false</span><br><span class="line">true</span><br><span class="line">false</span><br><span class="line">true</span><br></pre></td></tr></table></figure><p>从运行结果可以得出以下结论：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"Hello"</span> != <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">"Hello"</span>);    <span class="comment">// 字符串常量与new出来的String对象不是同一个对象</span></span><br><span class="line"><span class="string">"Hello"</span> == <span class="string">"Hello"</span>;    <span class="comment">// 两个字符串常量是同一个String对象</span></span><br><span class="line"></span><br><span class="line"><span class="type">String</span> <span class="variable">c</span> <span class="operator">=</span> <span class="string">"Hello"</span>;</span><br><span class="line">c + <span class="string">"World!"</span> != <span class="string">"Hello"</span> + <span class="string">"World!"</span>;</span><br><span class="line"><span class="string">"Hello"</span> + <span class="string">"World!"</span> == <span class="string">"HelloWorld!"</span>;</span><br><span class="line"><span class="comment">// c + "World!"运行时会调用StringBuilder.append进行字符串连接</span></span><br><span class="line"><span class="comment">// "Hello" + "World!"不会在运行时进行字符串连接，而是在编译时转成"HelloWorld!"常量</span></span><br></pre></td></tr></table></figure><h3>String字符串常量池的底层实现</h3><p>Java中所有的字符串常量都存储在字符串常量池中。比如上面Demo中的”Hello”，”HelloWorld!”这种字面量。</p><p>对于我们通过构造方法new出来的String对象都是创建在Java的堆内存中，这样的对象一旦失去引用后，我们就无法再次使用了，只能等着GC回收这个对象。</p><p>其实String中有个<code>intern()</code>方法，可以将我们new出来的字符串对象，加入到字符串常量池中，这样我们下次再使用这样的字面量时，Java会从池中返回这个对象的引用。</p><p>举个例子：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">StringBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line"><span class="comment">// 随机生成一个100以内的加法运算</span></span><br><span class="line">builder.append((<span class="type">int</span>)(Math.random()*<span class="number">100</span>));</span><br><span class="line">builder.append(<span class="string">'+'</span>);</span><br><span class="line">builder.append((<span class="type">int</span>)(Math.random()*<span class="number">100</span>));</span><br><span class="line">builder.append(<span class="string">'='</span>);</span><br><span class="line"><span class="type">String</span> <span class="variable">question</span> <span class="operator">=</span> builder.toString(); <span class="comment">// 此时的question对象并不在常量池中</span></span><br><span class="line">question.intern();<span class="comment">// 这句话能把生成的加法算式加入到字符串常量池中</span></span><br></pre></td></tr></table></figure><p>我们先看一下Java文档中是怎么描述这个方法的：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns a canonical representation for the string object.</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * A pool of strings, initially empty, is maintained privately by the</span></span><br><span class="line"><span class="comment"> * class {<span class="doctag">@code</span> String}.</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * When the intern method is invoked, if the pool already contains a</span></span><br><span class="line"><span class="comment"> * string equal to this {<span class="doctag">@code</span> String} object as determined by</span></span><br><span class="line"><span class="comment"> * the {<span class="doctag">@link</span> #equals(Object)} method, then the string from the pool is</span></span><br><span class="line"><span class="comment"> * returned. Otherwise, this {<span class="doctag">@code</span> String} object is added to the</span></span><br><span class="line"><span class="comment"> * pool and a reference to this {<span class="doctag">@code</span> String} object is returned.</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * It follows that for any two strings {<span class="doctag">@code</span> s} and {<span class="doctag">@code</span> t},</span></span><br><span class="line"><span class="comment"> * {<span class="doctag">@code</span> s.intern() == t.intern()} is {<span class="doctag">@code</span> true}</span></span><br><span class="line"><span class="comment"> * if and only if {<span class="doctag">@code</span> s.equals(t)} is {<span class="doctag">@code</span> true}.</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * All literal strings and string-valued constant expressions are</span></span><br><span class="line"><span class="comment"> * interned. String literals are defined in section 3.10.5 of the</span></span><br><span class="line"><span class="comment"> * &lt;cite&gt;The Java&amp;trade; Language Specification&lt;/cite&gt;.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span>  a string that has the same contents as this string, but is</span></span><br><span class="line"><span class="comment"> *          guaranteed to be from a pool of unique strings.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">native</span> String <span class="title function_">intern</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p>如果该在字符串常量池中已经有一个和该字符串值相等(equal)的字符串对象，则intern方法会返回池中的这个对象；如果没有，则将该字符串加入到字符串常量池中。</p><p>所以两个字符串只有当<code>s.equal(t)</code>成立才会有<code>s.intern() == t.intern()</code>。</p><p>intern方法是native方法，接下来我们看一下它的C/C++实现。</p><p>注意我的JDK和JVM源码是<code>openjdk-8-src-b132-03_mar_2014</code>这个版本的，不同版本源码可能会有所差别。</p><p>首先找到java/lang/String.c文件：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"jvm.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"java_lang_String.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">JNIEXPORT jobject JNICALL</span></span><br><span class="line"><span class="function"><span class="title">Java_java_lang_String_intern</span><span class="params">(JNIEnv *env, jobject <span class="keyword">this</span>)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">JVM_InternString</span>(env, <span class="keyword">this</span>);</span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>这个文件中就一个intern方法，底层调用的JVM的InternString方法。</p><p>找到Jvm.cpp：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">JVM_ENTRY</span>(jstring, <span class="built_in">JVM_InternString</span>(JNIEnv *env, jstring str))</span><br><span class="line">  <span class="built_in">JVMWrapper</span>(<span class="string">"JVM_InternString"</span>);</span><br><span class="line">  JvmtiVMObjectAllocEventCollector oam;</span><br><span class="line">  <span class="keyword">if</span> (str == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">  oop string = JNIHandles::<span class="built_in">resolve_non_null</span>(str);</span><br><span class="line">  oop result = StringTable::<span class="built_in">intern</span>(string, CHECK_NULL);</span><br><span class="line">  <span class="keyword">return</span> (jstring) JNIHandles::<span class="built_in">make_local</span>(env, result);</span><br><span class="line">JVM_END</span><br></pre></td></tr></table></figure><p>找到JVM_ENTRY和JVM_END这两个宏定义(interfaceSupport.hpp文件中)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> JVM_ENTRY(result_type, header)                               \</span></span><br><span class="line"><span class="meta">extern <span class="string">"C"</span> {                                                         \</span></span><br><span class="line"><span class="meta">  result_type JNICALL header {                                       \</span></span><br><span class="line"><span class="meta">    JavaThread* thread=JavaThread::thread_from_jni_environment(env); \</span></span><br><span class="line"><span class="meta">    ThreadInVMfromNative __tiv(thread);                              \</span></span><br><span class="line"><span class="meta">    debug_only(VMNativeEntryWrapper __vew;)                          \</span></span><br><span class="line"><span class="meta">    VM_ENTRY_BASE(result_type, header, thread)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> JVM_END } }</span></span><br></pre></td></tr></table></figure><p>展开宏定义，就可以看到JVM_InternString的定义了：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span> {</span><br><span class="line">  <span class="function">jstring JNICALL <span class="title">JVM_InternString</span><span class="params">(JNIEnv *env, jstring str)</span> </span>{</span><br><span class="line">    JavaThread* thread=JavaThread::<span class="built_in">thread_from_jni_environment</span>(env);</span><br><span class="line">    ThreadInVMfromNative __tiv(thread);</span><br><span class="line">    <span class="built_in">debug_only</span>(VMNativeEntryWrapper __vew;)</span><br><span class="line">    <span class="built_in">VM_ENTRY_BASE</span>(result_type, header, thread)</span><br><span class="line">    <span class="comment">// 前面几句不用管</span></span><br><span class="line">    <span class="built_in">JVMWrapper</span>(<span class="string">"JVM_InternString"</span>);</span><br><span class="line">    JvmtiVMObjectAllocEventCollector oam;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 下面两句是用来判空处理的</span></span><br><span class="line">    <span class="keyword">if</span> (str == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    oop string = JNIHandles::<span class="built_in">resolve_non_null</span>(str);<span class="comment">// 将jstring对象转成oop对象</span></span><br><span class="line"></span><br><span class="line">    oop result = StringTable::<span class="built_in">intern</span>(string, CHECK_NULL);</span><br><span class="line">    <span class="keyword">return</span> (jstring) JNIHandles::<span class="built_in">make_local</span>(env, result);<span class="comment">// 将oop对象还原成jstring对象</span></span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>最关键的部分就是<code>StringTable::intern</code>方法，先让我们看一下StringTable类的定义：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">StringTable</span> : <span class="keyword">public</span> Hashtable&lt;oop, mtSymbol&gt; {</span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">class</span> <span class="title class_">VMStructs</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">  <span class="comment">// 单例模式</span></span><br><span class="line">  <span class="type">static</span> StringTable* _the_table;</span><br><span class="line"></span><br><span class="line">  <span class="type">static</span> <span class="type">bool</span> _needs_rehashing;</span><br><span class="line"></span><br><span class="line">  <span class="type">static</span> <span class="keyword">volatile</span> <span class="type">int</span> _parallel_claimed_idx;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">static</span> oop <span class="title">intern</span><span class="params">(Handle string_or_null, jchar* chars, <span class="type">int</span> length, TRAPS)</span></span>;</span><br><span class="line">  <span class="function">oop <span class="title">basic_add</span><span class="params">(<span class="type">int</span> index, Handle string_or_null, jchar* name, <span class="type">int</span> len,</span></span></span><br><span class="line"><span class="params"><span class="function">                <span class="type">unsigned</span> <span class="type">int</span> hashValue, TRAPS)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function">oop <span class="title">lookup</span><span class="params">(<span class="type">int</span> index, jchar* chars, <span class="type">int</span> length, <span class="type">unsigned</span> <span class="type">int</span> hashValue)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 将构造方法私有</span></span><br><span class="line">  <span class="built_in">StringTable</span>() : <span class="built_in">Hashtable</span>&lt;oop, mtSymbol&gt;((<span class="type">int</span>)StringTableSize,</span><br><span class="line">                              <span class="built_in">sizeof</span> (HashtableEntry&lt;oop, mtSymbol&gt;)) {}</span><br><span class="line"></span><br><span class="line">  <span class="built_in">StringTable</span>(HashtableBucket&lt;mtSymbol&gt;* t, <span class="type">int</span> number_of_entries)</span><br><span class="line">    : <span class="built_in">Hashtable</span>&lt;oop, mtSymbol&gt;((<span class="type">int</span>)StringTableSize, <span class="built_in">sizeof</span> (HashtableEntry&lt;oop, mtSymbol&gt;), t,</span><br><span class="line">                     number_of_entries) {}</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="comment">// 获取StringTable单例</span></span><br><span class="line">  <span class="function"><span class="type">static</span> StringTable* <span class="title">the_table</span><span class="params">()</span> </span>{ <span class="keyword">return</span> _the_table; }</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">static</span> uint <span class="title">bucket_size</span><span class="params">()</span> </span>{ <span class="keyword">return</span> <span class="built_in">sizeof</span>(HashtableBucket&lt;mtSymbol&gt;); }</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 由JVM调用该方法来创建字符串缓冲池单例</span></span><br><span class="line">  <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">create_table</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="built_in">assert</span>(_the_table == <span class="literal">NULL</span>, <span class="string">"One string table allowed."</span>);</span><br><span class="line">    _the_table = <span class="keyword">new</span> <span class="built_in">StringTable</span>();</span><br><span class="line">  }</span><br><span class="line">  ...  <span class="comment">// 省略若干方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 查找(这个方法与Java中的Hashtable的get方法类似)</span></span><br><span class="line">  <span class="function"><span class="type">static</span> oop <span class="title">lookup</span><span class="params">(Symbol* symbol)</span></span>;</span><br><span class="line">  <span class="function"><span class="type">static</span> oop <span class="title">lookup</span><span class="params">(jchar* chars, <span class="type">int</span> length)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 存入(这个方法与Java中的Hashtable的put方法类似)</span></span><br><span class="line">  <span class="function"><span class="type">static</span> oop <span class="title">intern</span><span class="params">(Symbol* symbol, TRAPS)</span></span>;</span><br><span class="line">  <span class="function"><span class="type">static</span> oop <span class="title">intern</span><span class="params">(oop string, TRAPS)</span></span>;</span><br><span class="line">  <span class="function"><span class="type">static</span> oop <span class="title">intern</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *utf8_string, TRAPS)</span></span>;</span><br><span class="line">  ...  <span class="comment">// 省略若干方法</span></span><br><span class="line">}</span><br></pre></td></tr></table></figure><p>从源码可以看出：<strong>StringTable也就是所谓的字符串常量池实际上就是一个Hashtable，而且被设计成单例，通过<code>lookup()</code>来查找元素，<code>intern()</code>方法来添加元素。</strong></p><h3>String类中的几个工具方法</h3><p>对于String类中的许多成员方法，我们可能都非常熟悉。</p><p><code>substring</code>获取子串（截取字符串中的一部分），包含start，不包含end。</p><p><code>startsWith</code>和<code>endsWidth</code>来判断字符串头部和尾部的字符串</p><p><code>indexOf</code>从前往后进行字符串匹配，<code>lastIndexOf</code>从后往前进行字符串匹配</p><p><code>trim</code>去除字符串两端的空白字符(空格、换行等空白字符，即ASCII码0~32[空格])</p><p><code>split</code>字符串切分</p><p><code>concat</code>字符串连接，并返回一个新字符串，与C语言中的<code>strcat</code>函数类似</p><p><code>compareTo</code>用于字符串之间的比较(该方法实现自<code>Comparable</code>接口)，与C语言中的<code>strcmp</code>函数类似，按字母的编码顺序进行比较(字典序)，如果大于传入的字符串则返回值大于0，如果相等则返回值等于0，如果小于传入的字符串则返回值小于0</p><p><code>equals</code>用于比较字符串内容是否相同(该方法重写自<code>Object</code>类)，相同返回true，不相同返回false</p><p><code>compareToIgnoreCase</code>忽略大小写比较两个字符串</p><p><code>equalsIgnoreCase</code>忽略大小写比较两字符串内容是否相同</p><p><code>contentEquals</code>比较两个字符序列内容是否相同，传入参数只要是<code>CharSequence</code>接口的实现类即可</p><p><code>getBytes</code>获取字符串编码的字节数组，可以指定字符集编码</p><p><code>toLowerCase</code>转小写，<code>toUpperCase</code>转大写</p><p><code>replace</code>和<code>replaceAll</code>用于替换子串(可以使用正则)</p><p><code>replaceFirst</code>替换第一次出现(从前到后)的子串</p><p><code>matches</code>字符串是否能匹配正则</p><p>…</p><p>上面的方法我们都经常使用，但是<code>String</code>类的一些静态方法可能会被我们忽略掉。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这和C语言中的sprintf函数类似，用于将若干对象格式化成一个字符串</span></span><br><span class="line">String <span class="title function_">format</span><span class="params">(String format, Object... args)</span></span><br></pre></td></tr></table></figure><p>Java8中对<code>StringBuilder</code>类进行了一层封装——<code>StringJoiner</code>类，于是String类就多了个静态方法</p><blockquote><p>StringJoiner类真的很“鸡肋”，主要是为了1.8提供的函数式编程而设计的。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String <span class="title function_">join</span><span class="params">(CharSequence delimiter, CharSequence... elements)</span></span><br><span class="line">String <span class="title function_">join</span><span class="params">(CharSequence delimiter, Iterable&lt;? extends CharSequence&gt; elements)</span></span><br></pre></td></tr></table></figure><h2>StringBuffer与StringBuilder</h2><p>前面频繁提到了<code>StringBuffer</code>和<code>StringBuilder</code>这两个类，但很多初学者对这两个类区分不清：<strong>StringBuffer是线程安全的(方法基本上都是<code>synchronized</code>同步方法)，StringBuilder是线程不安全的(没有使用<code>synchronized</code>进行同步)；正因如此StringBuilder在效率上比StringBuffer要高</strong>。这一点上和<code>Vector</code>与<code>ArrayList</code>的关系是一样的。</p><p><img src="http://img-blog.csdn.net/20170623011629190?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSG9sbW9meQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" rel="external noreferrer nofollow noopener" referrerpolicy="no-referrer" alt="CharSequence"></p><blockquote><p>前面也提到Java中String的字符串连接就是使用StringBuilder实现的，但StringBuilder是Java5之后才添加的，在Java5之前都是使用StringBuffer类来实现的。Java中每次字符串连接都会重新创建一个StringBuilder类，所以不会出现多线程访问共享资源时发生的问题。</p></blockquote><p>除了前面所说的StringBuffer与StringBuilder之间的区别比较重要外，它们的扩容策略也值得我们探究，这也可能会成为影响我们程序内存效率的因素。</p><blockquote><p>它们的扩容策略是相同的</p></blockquote><p>首先我们先看一下这两个类的构造方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// StringBuilder</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">StringBuilder</span><span class="params">()</span> {</span><br><span class="line">    <span class="built_in">super</span>(<span class="number">16</span>);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">StringBuilder</span><span class="params">(<span class="type">int</span> capacity)</span> {</span><br><span class="line">    <span class="built_in">super</span>(capacity);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">StringBuilder</span><span class="params">(String str)</span> {</span><br><span class="line">    <span class="built_in">super</span>(str.length() + <span class="number">16</span>);</span><br><span class="line">    append(str);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">StringBuilder</span><span class="params">(CharSequence seq)</span> {</span><br><span class="line">    <span class="built_in">this</span>(seq.length() + <span class="number">16</span>);</span><br><span class="line">    append(seq);</span><br><span class="line">}</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// StringBuffer</span></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">StringBuffer</span><span class="params">()</span> {</span><br><span class="line">    <span class="built_in">super</span>(<span class="number">16</span>);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">StringBuffer</span><span class="params">(<span class="type">int</span> capacity)</span> {</span><br><span class="line">    <span class="built_in">super</span>(capacity);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">StringBuffer</span><span class="params">(String str)</span> {</span><br><span class="line">    <span class="built_in">super</span>(str.length() + <span class="number">16</span>);</span><br><span class="line">    append(str);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">public</span> <span class="title function_">StringBuffer</span><span class="params">(CharSequence seq)</span> {</span><br><span class="line">    <span class="built_in">this</span>(seq.length() + <span class="number">16</span>);</span><br><span class="line">    append(seq);</span><br><span class="line">}</span><br></pre></td></tr></table></figure><blockquote><p>它们的构造方法完全一致。</p><p>我们能通过传入<code>capacity</code>来设置它的初始容量，如果不指定则默认为16(一个char占2字节，就相当于32个字节)。如果我们能大致确定要连接的字符数量，最好还是指定一下它的初始容量，这样可以避免频繁的创建新数组和数组拷贝。</p></blockquote><p>这两个类的扩容策略是相同的，扩容策略的实现都被封装在它们的基类<code>AbstractStringBuilder</code>中：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">expandCapacity</span><span class="params">(<span class="type">int</span> minimumCapacity)</span> {</span><br><span class="line">    <span class="comment">// 扩容策略为：newCapacity = value.length * 2 + 2</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">newCapacity</span> <span class="operator">=</span> value.length * <span class="number">2</span> + <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (newCapacity - minimumCapacity &lt; <span class="number">0</span>)</span><br><span class="line">        newCapacity = minimumCapacity;</span><br><span class="line">    <span class="keyword">if</span> (newCapacity &lt; <span class="number">0</span>) {</span><br><span class="line">        <span class="keyword">if</span> (minimumCapacity &lt; <span class="number">0</span>) <span class="comment">// overflow</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OutOfMemoryError</span>();</span><br><span class="line">        newCapacity = Integer.MAX_VALUE;</span><br><span class="line">    }</span><br><span class="line">    value = Arrays.copyOf(value, newCapacity);</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div><div class="article-copyright"><p>本作品采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by/4.0/">知识共享署名 4.0 国际许可协议</a> 进行许可。</p><p>转载时请注明<a href="https://blog.hufeifei.cn/2017/05/Java/Java-Basic-Review/">原文链接</a>：https://blog.hufeifei.cn/2017/05/Java/Java-Basic-Review/</p></div><footer class="article-footer"></footer></div><div id="article-reward"><i class="iconfont ic-money"></i><div>鼓励一下</div><table><thead><tr><th style="text-align:center">支付宝</th><th style="text-align:center">微信</th></tr></thead><tbody><tr><td style="text-align:center"><img width="150" src="https://www.hufeifei.cn/reward-img/alipay.jpg"></td><td style="text-align:center"><img width="135" src="https://www.hufeifei.cn/reward-img/wechat.jpg"></td></tr></tbody></table></div><nav id="article-nav"><a class="article-nav-link-wrap" href="/2017/06/ComputerAndOS/%E4%BB%8EASCII%E5%88%B0Unicode/" id="article-nav-newer"><strong class="article-nav-caption">Newer</strong><div class="article-nav-title">编码全解：从ASCII/ISO-8859/GB2312/GBK到Unicode的UCS-2/UCS-4/UTF-8/UTF-16/UTF-32</div></a><a class="article-nav-link-wrap" href="/2017/05/Windows/Windows%E4%B8%8A%E4%BD%BF%E7%94%A8%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%AE%89%E8%A3%85MYSQL/" id="article-nav-older"><strong class="article-nav-caption">Older</strong><div class="article-nav-title">Windows上使用压缩包安装MYSQL</div></a></nav></article><div id="waline-comments"></div><script type="module">import { init } from 'https://unpkg.com/@waline/client@v3/dist/waline.js';init({"el":"#waline-comments","pageview":true,"enable":true,"serverURL":"https://api.waline.blog.hufeifei.cn","avatar":"mp","pageSize":10,"lang":"zh-cn","placeholder":"Just go go","visitor":true,"recordIP":true,"requiredFields":["nick"]});</script></section><aside id="sidebar"><div class="widget-wrap"><h3 class="widget-title">关注微信公众号</h3><div class="widget wechat"><img src="//www.hufeifei.cn/wechat-public-account.jpg"></div></div><div class="widget-wrap"><h3 class="widget-title">Categories</h3><div class="widget"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/C-C/">C&C++</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/J2EE/">J2EE</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux%E8%BF%90%E7%BB%B4/">Linux运维</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/">Ruby</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Rust/">Rust</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Windows/">Windows</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BB%A3%E7%A0%81%E6%97%A5%E5%B8%B8/">代码日常</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/">分布式</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%95%86%E4%B8%9A/">商业</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/">数据结构与算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB/">生活</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BB%8F%E6%B5%8E%E4%B8%8E%E9%87%91%E8%9E%8D/">经济与金融</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BD%91%E7%BB%9C/">网络</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/">计算机组成</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%A2%E8%AF%95/">面试</a></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">Tag Cloud</h3><div class="widget tagcloud"><a href="/tags/AVL/" style="font-size:11.11px">AVL</a> <a href="/tags/Alibaba/" style="font-size:14.44px">Alibaba</a> <a href="/tags/Android/" style="font-size:18.89px">Android</a> <a href="/tags/B-Tree/" style="font-size:12.22px">B-Tree</a> <a href="/tags/BKD-Tree/" style="font-size:10px">BKD-Tree</a> <a href="/tags/BST/" style="font-size:10px">BST</a> <a href="/tags/BigData/" style="font-size:11.11px">BigData</a> <a href="/tags/C/" style="font-size:14.44px">C</a> <a href="/tags/CGlib/" style="font-size:10px">CGlib</a> <a href="/tags/CS/" style="font-size:11.11px">CS</a> <a href="/tags/Canal/" style="font-size:10px">Canal</a> <a href="/tags/ClassLoader/" style="font-size:10px">ClassLoader</a> <a href="/tags/ClickHouse/" style="font-size:10px">ClickHouse</a> <a href="/tags/Config/" style="font-size:10px">Config</a> <a href="/tags/Cryptography/" style="font-size:10px">Cryptography</a> <a href="/tags/DB/" style="font-size:20px">DB</a> <a href="/tags/Dapper/" style="font-size:10px">Dapper</a> <a href="/tags/DataStructure/" style="font-size:14.44px">DataStructure</a> <a href="/tags/Debezium/" style="font-size:10px">Debezium</a> <a href="/tags/Diamond/" style="font-size:10px">Diamond</a> <a href="/tags/Distributed/" style="font-size:13.33px">Distributed</a> <a href="/tags/ElasticSearch/" style="font-size:10px">ElasticSearch</a> <a href="/tags/Encoding/" style="font-size:10px">Encoding</a> <a href="/tags/FastJson/" style="font-size:10px">FastJson</a> <a href="/tags/File/" style="font-size:10px">File</a> <a href="/tags/FlowMarketing/" style="font-size:10px">FlowMarketing</a> <a href="/tags/Grade/" style="font-size:10px">Grade</a> <a href="/tags/Gson/" style="font-size:10px">Gson</a> <a href="/tags/HTTP/" style="font-size:10px">HTTP</a> <a href="/tags/Handler/" style="font-size:10px">Handler</a> <a href="/tags/Hanlder/" style="font-size:10px">Hanlder</a> <a href="/tags/Hessian/" style="font-size:10px">Hessian</a> <a href="/tags/IO-Multiplex/" style="font-size:10px">IO-Multiplex</a> <a href="/tags/JAVA/" style="font-size:18.89px">JAVA</a> <a href="/tags/JVM/" style="font-size:10px">JVM</a> <a href="/tags/KD-Tree/" style="font-size:10px">KD-Tree</a> <a href="/tags/KDB-Tree/" style="font-size:10px">KDB-Tree</a> <a href="/tags/Kafka/" style="font-size:10px">Kafka</a> <a href="/tags/Kubernetes/" style="font-size:10px">Kubernetes</a> <a href="/tags/LSM-Tree/" style="font-size:11.11px">LSM-Tree</a> <a href="/tags/Linux/" style="font-size:17.78px">Linux</a> <a href="/tags/Lock/" style="font-size:11.11px">Lock</a> <a href="/tags/Lucene/" style="font-size:10px">Lucene</a> <a href="/tags/MQ/" style="font-size:10px">MQ</a> <a href="/tags/Macro/" style="font-size:10px">Macro</a> <a href="/tags/Magisk/" style="font-size:10px">Magisk</a> <a href="/tags/MultiDex/" style="font-size:10px">MultiDex</a> <a href="/tags/MySQL/" style="font-size:17.78px">MySQL</a> <a href="/tags/NIO/" style="font-size:10px">NIO</a> <a href="/tags/Nginx/" style="font-size:11.11px">Nginx</a> <a href="/tags/OGNL/" style="font-size:10px">OGNL</a> <a href="/tags/OpenResty/" style="font-size:10px">OpenResty</a> <a href="/tags/OpenTelemetry/" style="font-size:10px">OpenTelemetry</a> <a href="/tags/Oracle/" style="font-size:10px">Oracle</a> <a href="/tags/PostgreSQL/" style="font-size:10px">PostgreSQL</a> <a href="/tags/RB-Tree/" style="font-size:10px">RB-Tree</a> <a href="/tags/Redis/" style="font-size:10px">Redis</a> <a href="/tags/Rust/" style="font-size:10px">Rust</a> <a href="/tags/Sharding/" style="font-size:10px">Sharding</a> <a href="/tags/SpringBoot/" style="font-size:10px">SpringBoot</a> <a href="/tags/SpringCloud/" style="font-size:10px">SpringCloud</a> <a href="/tags/SpringCloudConfig/" style="font-size:10px">SpringCloudConfig</a> <a href="/tags/Sqlite/" style="font-size:10px">Sqlite</a> <a href="/tags/SurfaceView/" style="font-size:10px">SurfaceView</a> <a href="/tags/VSCode/" style="font-size:11.11px">VSCode</a> <a href="/tags/WebFlux/" style="font-size:10px">WebFlux</a> <a href="/tags/WebPush/" style="font-size:10px">WebPush</a> <a href="/tags/Web%E6%8C%96%E6%8E%98/" style="font-size:11.11px">Web挖掘</a> <a href="/tags/awk/" style="font-size:10px">awk</a> <a href="/tags/bit-hack/" style="font-size:10px">bit-hack</a> <a href="/tags/cheat-sheet/" style="font-size:10px">cheat sheet</a> <a href="/tags/curl/" style="font-size:10px">curl</a> <a href="/tags/epoll/" style="font-size:10px">epoll</a> <a href="/tags/gRPC/" style="font-size:10px">gRPC</a> <a href="/tags/grep/" style="font-size:10px">grep</a> <a href="/tags/kqueue/" style="font-size:10px">kqueue</a> <a href="/tags/libev/" style="font-size:10px">libev</a> <a href="/tags/libevent/" style="font-size:10px">libevent</a> <a href="/tags/libuv/" style="font-size:10px">libuv</a> <a href="/tags/metaq/" style="font-size:10px">metaq</a> <a href="/tags/poll/" style="font-size:10px">poll</a> <a href="/tags/sed/" style="font-size:10px">sed</a> <a href="/tags/select/" style="font-size:10px">select</a> <a href="/tags/ssh/" style="font-size:10px">ssh</a> <a href="/tags/%E5%8E%86%E5%8F%B2/" style="font-size:10px">历史</a> <a href="/tags/%E5%95%86%E4%B8%9A/" style="font-size:10px">商业</a> <a href="/tags/%E5%BF%83%E7%90%86%E5%AD%A6/" style="font-size:10px">心理学</a> <a href="/tags/%E7%94%9F%E6%B4%BB/" style="font-size:11.11px">生活</a> <a href="/tags/%E7%A8%8E%E6%94%B6/" style="font-size:10px">税收</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:14.44px">算法</a> <a href="/tags/%E7%BB%8F%E6%B5%8E/" style="font-size:15.56px">经济</a> <a href="/tags/%E8%90%A5%E9%94%80/" style="font-size:10px">营销</a> <a href="/tags/%E8%B4%A7%E5%B8%81/" style="font-size:10px">货币</a> <a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size:16.67px">随笔</a></div></div><div class="widget-wrap"><h3 class="widget-title">Recent Posts</h3><div class="widget"><ul><li><a href="/2024/04/economic/value-added-tax/">增值税与贫富差距</a></li><li><a href="/2024/01/Net/x-forward-for/">“真”的IP真的是真的吗？</a></li><li><a href="/2024/01/paper/MarkupLM-web-extract/">【译】基于MarkupLM的web数据抽取</a></li><li><a href="/2023/09/economic/tax-reform/">直接税改革——王朝周期律的胜负手</a></li><li><a href="/2023/09/Rust/macro-rules-learning/">Rust中的宏</a></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">网站运营不易</h3><div class="ads-wrapper"><div class="google_ads"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7111912103882824" data-ad-slot="8429272980" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div></aside></div><footer id="footer"><div class="outer"><div class="inner" id="footer-info"><p><a href="https://beian.miit.gov.cn/" target="_blank">赣ICP备17009276号</a><i class="far fa-copyright"></i>2016 ~ 2024 胡飞飞</p><p>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a><i class="fas fa-angle-right"></i>Theme by <a target="_blank" rel="noopener" href="https://github.com/holmofy/hexo-theme-paper">paper</a></p></div></div></footer></div><nav id="mobile-nav"><a class="mobile-nav-link" href="//www.hufeifei.cn">主页</a><a class="mobile-nav-link" href="/">博客</a><a class="mobile-nav-link" href="/archives">归档</a><a class="mobile-nav-link" target="_blank" rel="noopener" href="//algo.hufeifei.cn">算法</a><a class="mobile-nav-link" href="/book">书籍</a><a class="mobile-nav-link" href="/github">Github</a></nav><script src="//cdnjs.loli.net/ajax/libs/jquery/3.0.0/jquery.min.js"></script><link rel="stylesheet" href="//cdnjs.loli.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="//cdnjs.loli.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/script.js"></script></div><script>
  $(document).ready(function() {
    $('figure.codeblock').find('.tab').click(function() {
        var $codeblock = $(this).parent().parent().parent();
        var $tab = $(this);
        // remove "active" css class on all tabs
        $tab.siblings().removeClass('active');
        // add "active" css class on the clicked tab
        $tab.addClass('active');
        // hide all tab contents
        $codeblock.find('.highlight').hide();
        // show only the right one
        $codeblock.find('.highlight.' + $tab.text()).show();
    });
  });
  </script><script>(function (w, d, s, id) {
            if (typeof (w.webpushr) !== 'undefined') return; w.webpushr = w.webpushr || function () { (w.webpushr.q = w.webpushr.q || []).push(arguments) }; var js, fjs = d.getElementsByTagName(s)[0]; js = d.createElement(s); js.id = id; js.async = 1; js.src = "https://cdn.webpushr.com/app.min.js";fjs.parentNode.appendChild(js);}(window, document, 'script', 'webpushr-jssdk'));webpushr('setup', { 'key': 'BPJzNs1QEtbYa3Bn0gMAQHBAzX3Jm71llGUKHTkKEUs3D9xiDYZ0DWJ3S9sfCAAJHxXEoBkUANFyONjeIlgrJUo'' });</script></body></html>
---
title: 远程连接Oracle的配置
date: 2017-08-17 14:49:23
tags:
categories: Linux运维
---

[前两天在CentOS7上装了Oracle](http://blog.csdn.net/holmofy/article/details/77622284)，但每次都需要shell远程登录oracle用户才能在服务器上使用sqlplus进行数据库操作。感觉真尼玛麻烦，直接拿个Windows上的Oracle客户端连上去多爽，所以今天就折腾了一番，整理出来以防将来再走弯路。

# 选择客户端

我的本上客户端有很多，比如图形界面的有：

* Navicat Premium(能连Oracle，MySQL，SqlLite，SqlServer，PostgreSQL等常见数据库)，这个比较喜欢，以前经常用来连MySQL

* IntelliJ IDEA里面自带了一个连接数据库的插件，能连接各种常见的数据库，功能也挺强大的。而且[JetBrains](https://baike.baidu.com/item/JetBrains)公司还专门把数据库部分单独抽离出来成了[DataGrip](https://www.jetbrains.com/datagrip/)。

  ![IDEA](http://img-blog.csdn.net/20170830184043276?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSG9sbW9meQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

* EclipseJavaEE版本内部也自带了一个连接数据库的插件，支持的数据库也比较全，但是使用上不太友好，需要自己搞数据库驱动。

  ![Eclipse](http://img-blog.csdn.net/20170830184127255?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSG9sbW9meQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

除了这几个通用的能够连接各种数据库，还有几个专门用于Oracle数据库的客户端(不过我都没装)，如：

* 鼎鼎大名的[PL/SQL Developer](https://www.allroundautomations.com/)，这个是一个专门用来进行Oracle数据库开发的集成开发环境。下载地址：https://www.allroundautomations.com/bodyplsqldevreg.html
* 还有Oracle自家产的[SQL Developer](http://www.oracle.com/technetwork/developer-tools/sql-developer/downloads/index.html)，这个完全没用过(没有体验过就没有发言权)

如果你比较喜欢命令行方式的操作，或者对上面这些巨无霸(其实除了两个IDE其他的都还好)感到厌烦，那还可以使用轻量、便捷又装逼的命令行客户端：

* 与Oracle自带的SQLplus客户端，这个可以从官方单独下载客户端使用，下载地址：http://www.oracle.com/technetwork/database/features/instant-client/index-097480.html
* 和上面Oracle的SQL Developer配套的命令行应用，这个也可以单独使用，下载地址：http://www.oracle.com/technetwork/developer-tools/sqlcl/overview/index.html

# 配置服务端的网络环境

在Oracle服务端有两个文件需要配置：

> 在`$ORACLE_HOME/network/admin/samples`目录下有这几个配置文件的示例配置。

1、`$ORACLE_HOME/network/admin/listeners.ora`

该文件指定了数据库服务器主机地址、端口号，配置了这个文件，Oracle就会通过该地址该端口监听客户端发送过来的连接请求。

```shell
# listener.ora Network Configuration File: /oracle/app/network/admin/listener.ora
# Generated by Oracle configuration tools.

LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))
      # 修改监听地址
      (ADDRESS = (PROTOCOL = TCP)(HOST = 10.3.155.207)(PORT = 1521))
    )
  )

# 配置监听的服务ID
SID_LIST_LISTENER =
(SID_LIST =
  (SID_DESC =
    (GLOBAL_DBNAME = orcl)
    (SID_NAME = oracleSID)
  )
)

ADR_BASE_LISTENER = /oracle
```

2、 `$ORACLE_HOME/network/admin/tnsnames.ora`

客户端想要连接到数据库，还需要一个连接字符串，连接字符串中指定协议和数据库服务名。一个数据库可以定义多个服务名，因此需要在连接字符串中指定服务名。在默认情况下，只有一个服务名，即全局数据库名。

```shell
# tnsnames.ora Network Configuration File: /oracle/app/network/admin/tnsnames.ora
# Generated by Oracle configuration tools.

ORCL =
  (DESCRIPTION =
    (ADDRESS_LIST =
      # 修改监听地址
      (ADDRESS = (PROTOCOL = TCP)(HOST = 10.3.155.207)(PORT = 1521))
    )
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = orcl)
    )
  )
```

# 检测监听状态

![listener control](http://img-blog.csdn.net/20170830184324364?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSG9sbW9meQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

> 如果报错说没有启动，就使用`lsnrctl start`命令启动监听

![restart](http://img-blog.csdn.net/20170830184604633?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSG9sbW9meQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

启动完成后使用`netstat -tanp`命令会有看到1521端口正被tnslsnr进行监听

![netstat](http://img-blog.csdn.net/20170830184639500?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSG9sbW9meQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

# 客户端连接

先用telnet测试一下Oracle服务端的1521端口是否已经打开。

![telnet测试连接](http://img-blog.csdn.net/20170830184810481?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSG9sbW9meQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

如果连接不上则需要在查看Oracle服务端的防火墙是否打开该端口。

如果能连接上即可使用Oracle客户端连接数据库了。这里截几个我常用的客户端截图

* IDEA，很方便，点击一下驱动就帮我们下好了。

![IDEA](http://img-blog.csdn.net/20170830184840319?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSG9sbW9meQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

* Navicat

![Navicat](http://img-blog.csdn.net/20170830184924847?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSG9sbW9meQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

* SQLplus(客户端)

  ![sqlplus](http://img-blog.csdn.net/20170830184950767?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvSG9sbW9meQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

> 参考链接：
>
> * Oracle 11g官方文档：
>   http://docs.oracle.com/cd/E11882_01/index.htm
>   http://docs.oracle.com/cd/E11882_01/network.112/e41945/gettingstart.htm
